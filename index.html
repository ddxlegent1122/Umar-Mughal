<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Global Number Extractor</title>
  <style>
    :root{
      --wallpaper: url('https://images.unsplash.com/photo-1519389950473-47ba0277781c');
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      color:#fff;
      min-height:100vh;
      background: var(--wallpaper) no-repeat center center fixed;
      background-size:cover;
      display:flex;align-items:center;justify-content:center;padding:24px;
    }
    .overlay{
      position:fixed;inset:0;background:rgba(0,0,0,.45);
    }
    .container{
      position:relative;
      width:100%;max-width:820px;
      background:rgba(0,0,0,.72);
      backdrop-filter: blur(4px);
      border-radius:16px;
      padding:22px;
      box-shadow:0 12px 40px rgba(0,0,0,.4);
      z-index:1;
    }
    h1{margin:0 0 10px 0;font-weight:700}
    .sub{opacity:.9;margin:0 0 16px 0}
    textarea{
      width:100%;min-height:180px;resize:vertical;
      border:none;border-radius:12px;padding:12px;font-size:15px;outline:none
    }
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    button{
      background:#28a745;border:none;color:#fff;
      padding:10px 16px;border-radius:10px;font-size:15px;cursor:pointer
    }
    button:hover{background:#218838}
    .result-wrap{
      margin-top:16px;background:#fff;color:#111;border-radius:12px;padding:12px
    }
    .result-head{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:8px}
    .modes{display:flex;gap:8px;flex-wrap:wrap}
    .mode-btn{background:#0d6efd}
    .mode-btn:hover{background:#0b5ed7}
    .count{font-size:13px;color:#555}
    #result{width:100%;height:220px;border:none;outline:none;resize:vertical}
    footer{margin-top:14px;text-align:center;color:#ddd}
  </style>
</head>
<body>
  <div class="overlay"></div>
  <div class="container">
    <h1>ðŸ“± Global Number Extractor</h1>
    <p class="sub">Paste any text below â€” supports all country codes (+1, +32, +39, +251, â€¦). Max 500 numbers.</p>

    <textarea id="input" placeholder="Paste your mixed text or list with phone numbers here..."></textarea>

    <div class="row">
      <button onclick="extractNumbers()">Extract Numbers</button>
    </div>

    <div class="result-wrap">
      <div class="result-head">
        <div class="modes">
          <button class="mode-btn" onclick="setMode(true)">Show WITH Country Code</button>
          <button class="mode-btn" onclick="setMode(false)">Show WITHOUT Country Code</button>
        </div>
        <span id="count" class="count">0 found</span>
      </div>
      <textarea id="result" readonly></textarea>
      <div class="row">
        <button onclick="copyNumbers()">ðŸ“‹ Copy</button>
      </div>
    </div>

    <footer>Developed by Umar Mughal</footer>
  </div>

  <!-- Country code list (1â€“3 digits) -->
  <script src="codes.js"></script>
  <script>
    let parsed = [];      // {code, local}
    let showWith = true;  // display mode

    function setMode(withCode){
      showWith = withCode;
      render();
    }

    function extractNumbers(){
      const text = document.getElementById('input').value;

      // 1) Find raw candidates that start with + and may include spaces, dashes, dots, or brackets
      // Example matches: "+32 478-123-456", "+39(331)1234567", "+251700829560"
      const rawMatches = text.match(/\+[\d][\d\s().-]{5,30}\d/g) || [];

      // 2) Normalize and validate using the official codes list (1â€“3 digits)
      const codesSorted = [...countryCodes].sort((a,b)=>b.length-a.length); // try longest first
      const seen = new Set();
      parsed = [];

      for(const raw of rawMatches){
        // Remove everything except digits, but keep the leading +
        const cleaned = '+' + raw.replace(/[^0-9]/g,'');
        // Total digits after + (E.164: up to 15)
        const digits = cleaned.slice(1);
        if(digits.length < 8 || digits.length > 15) continue;

        // Detect country code by real list (prefer the longest match)
        let codeFound = null;
        for(const code of codesSorted){
          if(digits.startsWith(code)){
            codeFound = code;
            break;
          }
        }
        if(!codeFound) continue;

        const local = digits.slice(codeFound.length);
        if(local.length < 4) continue; // basic sanity

        // Deduplicate by the chosen display form with code
        const full = `+${codeFound}${local}`;
        if(seen.has(full)) continue;
        seen.add(full);

        parsed.push({code: codeFound, local});
        if(parsed.length >= 500) break;
      }

      render();
    }

    function render(){
      const out = document.getElementById('result');
      const list = parsed.map(p => showWith ? `+${p.code}${p.local}` : p.local);
      out.value = list.join('\n');
      document.getElementById('count').textContent = `${list.length} found`;
    }

    function copyNumbers(){
      const out = document.getElementById('result');
      out.select();
      document.execCommand('copy');
      alert('âœ… Numbers copied to clipboard!');
    }
  </script>
</body>
</html>